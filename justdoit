#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <locale.h>

int VerificaCarac(char * str);


int main(){
    //Os dialogos anteriores podiam sumir :/
    setlocale(LC_ALL, "Portuguese");
    char entry;
    //menu do jogo?
    //JOGAR ->
    //tela preta que vai ficando mais clara

    //passaro fala:
    printf("???: Ei, voce finalmente acordou.\n");
    printf("???: Tudo bem, e dificil no comeco, voce pode pressionar qualquer tecla para continuar.\n");
    scanf("%c", &entry); //IDEIA-----NAO PRECISAR DO ENTER PARA CONTINUAR, APENAS O CARACTER-----REPETE-SE-----//
    printf("???: Otimo.\n");
    printf("???: Acho que estou com fome, que tal prepararmos alguma coisa?\n");

    char dialogoinicial[4][1000] = {"0",
                                    "(1) Calmai! O que e voce?\n(2) Calmai! Quem e voce?",
                                    "???: Nossa, o que sou eu? Isso doeu...",
                                    "???: Bem... isso e complicado..."
    };

    
    int i = 1, d;
    while(i != 0){
        printf("%s\n", dialogoinicial[i]);
        if(i == 2 || i == 3) break;
        scanf("%d", &d);

        switch (d){
            case 1:
                i = i*2;
                break;

            case 2:
                i = i*2 + 1;
                break;
        
            default:
                printf("???: Nao entendi. Opcao 1 ou 2?\n");
                scanf("%d", &d);
                break;
        }  

        

    }
    i = d = 1;

    printf("???: Por enquanto, sou apenas um passaro que ira te acompanhar em sua jornada.\n");


    char cafedamanha[8][1000] = {"0", 
                            "???: Mas entao, vamos fazer tapioca ou pao?", 
                            "???: Hum, ok, tapioca com queijo ou manteiga?",
                            "???: Pao! Adoro! Misto ou com manteiga?",
                            "???: Deixa eu experimentar... Tapioca com queijo ta uma delicia!",
                            "???: Tapioca nao ta tao boa, mas da pra engolir...",
                            "???: Deixa eu experimentar... Pao ta uma delicia.", 
                            "???: O pao ta gostosinho, mas poderia ter colocado menos manteiga ne..."
                            };
    

    //for(i=1;i<8;i++) printf("\nLinha %d: %s\n", i, cafedamanha[i]);

    while(i != 0){
        printf("%s\n", cafedamanha[i]);
        if(i == 4 || i == 5 || i == 6 || i == 7) break;
        scanf("%d", &d);

        switch (d){
            case 1:
                i = i*2;
                break;

            case 2:
                i = i*2 + 1;
                break;
        
            default:
                printf("???: Nao entendi.\n");
                break;
        }   
    }

    printf("\n"); //scanf("%c", &entry); //IDEIA-------desacelerar o jogo-----REPETE-SE---
    //pode ser o enter

    char nomepassaro[20];
    int nome_ounao = 1; //presença de nome ou n
    //em outro momento da historia ele pergunta o nome

    printf("???: Ei, o que acha de me dar um nome? Seria mais legal!\n");

    char qualmeunome[4][1000] = {"0",
                                    "(1) Eh realmente necessario?\n(2) Tudo bem...",
                                    "Ok, isso me machucou.",
                                    "Esse eh o espirito!"
    };

    
    i = 1;
    while(i != 0){
        printf("%s\n", qualmeunome[i]);
        if(i == 2 || i == 3) break;
        scanf("%d", &d);

        switch (d){
            case 1:
                i = i*2;
                nome_ounao = 0;
                break;

            case 2:
                i = i*2 + 1;
                break;
        
            default:
                printf("???: Nao entendi. Opcao 1 ou 2?\n"); //INCOMPLETO--------REPETE-SE!!------
                break;
        }  
    }

    
    
    if(nome_ounao != 0){
        printf("???: Entao, qual vai ser meu nome?!\n");
        scanf("%*c"); //gab att
        scanf("%[^\n]", nomepassaro);

        //se houver presença de pelo menos um simbolo tem-se:
        while( VerificaCarac(nomepassaro) == 1 ){ //nomepassaro
            printf("???: Esse nome nao me parece apropriado, que tal tentar outro?\n");
            scanf("%*c"); //gab att
            scanf("%[^\n]", nomepassaro);
        }
        
        printf("%s: Ei! Tudo certo! Me sinto vivo. %s eh um otimo nome!\n", nomepassaro, nomepassaro);
    }
    else sprintf( nomepassaro, "???");


        printf("\n");//scanf("%c", &entry); //desacelerar o jogo
        //pode ser o enter

        printf("%s: Beleza, caro amigo, posso saber seu nome?\n");

    char dialogprotagnome[4][1000] = {"0",
                                    "(1) Nao.\n(2) Ah... Claro...",
                                    "Voce me odeia?",
                                    "Yey!"
    };

    char nomeprotag[20];

    int nome2_ounao = 1; //presença de nome ou n
    
    i = 1;
    while(i != 0){
        printf("%s\n", dialogprotagnome[i]);
        if(i == 2 || i == 3) break;
        scanf("%d", &d);

        switch (d){
            case 1:
                i = i*2;
                nome2_ounao = 0;
                break;

            case 2:
                i = i*2 + 1;
                break;
        
            default:
                printf("???: Nao entendi. Opcao 1 ou 2?\n");
                break;
        }  
    }


    if(d==2){
        printf("/---OBS: Lembre-se de colocar um nome masculino.---/\n"); //tem uma maneira mais sutil de relembrar isso?
        printf("Meu nome eh ");
        scanf("%*c");
        scanf("%[^\n]", nomeprotag);


        //se houver presença de pelo menos um simb no nome tem-se:
        while( VerificaCarac(nomeprotag) == 1 ){
            printf("???: Acho que seu nome nem existe ou sua mae te odeia, que tal tentar de novo?\n");
            scanf("%*c");
            scanf("%[^\n]", nomeprotag);
        }


        printf("%s: Wow! Nome legal, %s, hein?, queria que fosse o meu...\n", nomepassaro, nomeprotag);
    }
    else{
        printf("\n");
        printf("(O passaro olha ao redor de seu quarto e acaba encontrando uma carta assinada por voce)\n");

        printf("\n"); //scanf("%c", &entry); //desacelerar o jogo
        //pode ser o enter

        printf("/---OBS: Lembre-se de colocar um nome masculino.---/\n");
        printf("%s: Ei, olha so! Nao tem como escapar de mim. Seu nome eh... Calma, que letra dificil... Ok, seu nome eh... ", nomepassaro);
        scanf("%*c");
        scanf("%[^\n]", nomeprotag);


        while( VerificaCarac(nomeprotag) == 1 ){
            printf("???: Isso nao eh possivel, deixa eu reler...\n");
            scanf("%*c");
            scanf("%[^\n]", nomeprotag);
        }


        printf("%s: Aha! Ok, amigo %s, nao se preocupe. Nao vou te machucar\n", nomepassaro, nomeprotag);
    }


    printf("\n");
    //--------------DETALHES DA ATUALIZAÇÃO-------------//
    //DATA: 21/12
    //AUTOR(A): MARI E GABS
    //COMENTARIO DA ATUALIZAÇÃO: adicionei interação do nome do passaro e do protag + ideias
    //INCOMPLETO: ta comentado :P
    //-----------THANKS FOR YOU CONTRIBUTION-----------//


    printf("The End\n");
 


  return 0;
}

int VerificaCarac(char * str){
    int i, ops = 0;
   
    for(i=0; i < strlen(str); i++){
        //printf("%c", str[i]);
        if( ( (int)str[i] >= 33 && (int)str[i] <= 64 ) || ( (int)str[i] >= 91 && str[i] <= 96 ) || ( (int)str[i] >= 123) ){
            ops = 1;
            break;
        }
    }
    if(ops == 1) return 1;
    else return 0;
}
